<!DOCTYPE html>
<html lang="en-us">
    <head>
        <script data-ad-client="ca-pub-6244473643910448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<meta name="google-site-verification" content="9qs7VjxtSrYMqw5OElxCdKv_gnssSRi6acB2iYlZnGA" />
<meta property="og:url" content="https://www.kaitoy.xyz/2018/11/26/creating-react-redux-app-from-scratch-11/">
<meta property="og:site_name" content="To Be Decided">
<meta name="twitter:card" content="summary"></meta>
<link rel="canonical" href="https://www.kaitoy.xyz/2018/11/26/creating-react-redux-app-from-scratch-11/">



  <meta property="og:type" content="article">
  <meta property="og:title" content="React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その11: FlowからTypeScriptへ移行 | To Be Decided">
  <title>React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その11: FlowからTypeScriptへ移行 | To Be Decided</title>
  <meta property="og:description" content="ReactとReduxを学ぶために、開発環境というかプロジェクトテンプレートをスクラッチから作っている。
(最終的な成果はGitHubに置いた。)

前回はCode Splitting、Flow、Jest、Enzymeをセットアップした。

前回でこのシリーズを終わりにするつもりだったけど、型システムをFlowからTypeScriptに移行したのでそれについて書く。">
  <meta name="description" content="ReactとReduxを学ぶために、開発環境というかプロジェクトテンプレートをスクラッチから作っている。
(最終的な成果はGitHubに置いた。)

前回はCode Splitting、Flow、Jest、Enzymeをセットアップした。

前回でこのシリーズを終わりにするつもりだったけど、型システムをFlowからTypeScriptに移行したのでそれについて書く。">
  <meta property="og:image" content="https://www.kaitoy.xyz/images/typescript.png">



        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <style>

    html body {
        font-family: 'Noto Sans JP', sans-serif;
        background-color: #fefefe;
    }

    :root {
        --accent: #fa1e44;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://www.kaitoy.xyz/css/main.css">






<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
<script>
  var webFontConfig = {
    google: {
      families: ['Noto Sans JP:400,700:japanese'],
      active: function() {
        sessionStorage.fonts = true;
      }
    },
    timeout: 3000
  };
  WebFont.load(webFontConfig);
</script>


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/monokai.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

    

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>








<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.55.1" />
        
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65248565-1"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());

          gtag('config', 'UA-65248565-1');
        </script>
        
    </head>

    

    <body>
         
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v9.0" nonce="WjvU2Pqv"></script>

        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その11: FlowからTypeScriptへ移行</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/tags/">Tags</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:kaitoy@pcap4j.org"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/kaitoy"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/kaito-yamada-8558b913a"><i class="fa fa-linkedin"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.facebook.com/yamada.kaito.90"><i class="fa fa-facebook-square"></i></a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>


<main>

    <div class="single-post">
        <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/11/26/creating-react-redux-app-from-scratch-11/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その11: FlowからTypeScriptへ移行</a></h4>
    <h5>Mon, Nov 26, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    

</div>


        <div class="cover">
            <a href="/2018/11/26/creating-react-redux-app-from-scratch-11/">
                <img src="https://www.kaitoy.xyz/images/typescript.png" alt="React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その11: FlowからTypeScriptへ移行">
            </a>
        </div>

        
        <h4 class="page-header">Table of Contents</h4>
        <aside>
            <nav id="TableOfContents">
<ul>
<li><a href="#typescript">TypeScript</a></li>
<li><a href="#typescript-vs-flow">TypeScript vs Flow</a></li>
<li><a href="#flowからtypescriptへの移行">FlowからTypeScriptへの移行</a>
<ul>
<li><a href="#脱flow">脱Flow</a></li>
<li><a href="#typescript導入">TypeScript導入</a>
<ul>
<li><a href="#パッケージインストール">パッケージインストール</a></li>
<li><a href="#typescriptの設定">TypeScriptの設定</a></li>
<li><a href="#webpackの設定">webpackの設定</a></li>
<li><a href="#フォーマッタの設定">フォーマッタの設定</a></li>
<li><a href="#リンタの設定">リンタの設定</a></li>
<li><a href="#javascriptをtypescriptへ書き換える">JavaScriptをTypeScriptへ書き換える</a>
<ul>
<li><a href="#reactコンポーネントの型">Reactコンポーネントの型</a></li>
<li><a href="#reduxのactionの型">ReduxのActionの型</a></li>
<li><a href="#reduxのreducerの型">ReduxのReducerの型</a></li>
<li><a href="#スクリプト以外をimportするコードを修正">スクリプト以外をimportするコードを修正</a></li>
</ul></li>
<li><a href="#jestの設定">Jestの設定</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
        </aside>
        <hr>
        

        <br> <div class="text-justify"><p><a href="https://reactjs.org/">React</a>と<a href="https://redux.js.org/">Redux</a>を学ぶために、開発環境というかプロジェクトテンプレートをスクラッチから作っている。
(最終的な成果は<a href="https://github.com/kaitoy/react-redux-scaffold">GitHub</a>に置いた。)</p>

<p><a href="https://www.kaitoy.xyz/2018/11/07/creating-react-redux-app-from-scratch-10/">前回</a>は<a href="https://reactjs.org/docs/code-splitting.html">Code Splitting</a>、<a href="https://flow.org/">Flow</a>、<a href="https://jestjs.io/ja/">Jest</a>、<a href="https://airbnb.io/enzyme/">Enzyme</a>をセットアップした。</p>

<p>前回でこのシリーズを終わりにするつもりだったけど、型システムをFlowから<a href="https://www.typescriptlang.org/">TypeScript</a>に移行したのでそれについて書く。</p>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6244473643910448"
     data-ad-slot="1845600530"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h1 id="typescript">TypeScript</h1>

<p>TypeScriptはMicrosoft製のAltJS。
もともとは<a href="https://coffeescript.org/">CoffeeScript</a>のように言語の機能面(e.g. class構文やアロー関数)を補強しつつ、静的型付けをサポートする言語だったが、最近はECMAScriptが前者をカバーしてるので、後者を主な目的として使う人が多い。</p>

<p>2012年に誕生した言語で、同様に静的型付けをサポートするFlowよりも2歳ほど年上。</p>

<h1 id="typescript-vs-flow">TypeScript vs Flow</h1>

<p>個人的には、静的型付けだけを目的にするならAltJSである必要はなく、静的型付けだけを補完するFlowのほうが筋がいいような気がする。
TypeScriptはECMAScriptの進化に追従すべく、追加される機能や構文をサポートするためのエンハンスを繰り返しているが、そこはBabelに任せて静的型付けに注力したらいいような。</p>

<p>とはいえ、以下のような点を鑑み、結局TypeScriptを選択した。</p>

<ul>
<li>TypeScriptの方が人気

<ul>
<li>GitHubのプロジェクトのスター数はTypeScriptが4万超えでFlowが2万弱。</li>
<li>観測している限り、FlowからTypeScriptへ移行したというのは聞くが、逆は聞かない。</li>
<li>人気があるということはコミュニティやエコシステムが大きいということ。</li>
</ul></li>
<li>TypeScriptがノってる

<ul>
<li><a href="https://github.com/babel/babylon/pull/523">Babel</a>や<a href="https://github.com/facebook/create-react-app/pull/4837">Create React App</a>がTypeScriptをサポートして来ていて、なんだか時流にのっている。</li>
</ul></li>
<li>Flowは型定義ファイルの管理方法が微妙

<ul>
<li>Flowはflow-typedという専用のツールを使ってファイルをダウンロードし、ダウンロードしたものをGitとかのVCSでバージョン管理するというやりかた。</li>
<li>TypeScriptはnpmで管理されてるので、Yarnでダウンロードもバージョン管理もできる。VCSのリポジトリに自前のコードしか入れないで済むのもいい。</li>
</ul></li>
<li>TypeScriptの方が型定義ファイルが沢山提供されてる

<ul>
<li>Flowの10倍くらいある。</li>
</ul></li>
<li>TypeScriptの方がエラーメッセージが分かりやすい

<ul>
<li>というのをどこかで聞いた。</li>
</ul></li>
<li>Flowの方が段階的に型を導入できる、というのは昔の話

<ul>
<li>今はTypeScriptもオプションによって段階的に導入できるというのが定評。</li>
<li>そもそも最初から型付けするならどうでもいい。</li>
</ul></li>
<li>Flowの方が厳密な型チェックしてくれる、というのも昔の話

<ul>
<li>TypeScriptが追い付いてきて、今はほぼ同程度らしい。</li>
</ul></li>
<li>TypeScript+<a href="https://code.visualstudio.com/">VSCode</a>の開発体験が最高すぎるらしい

<ul>
<li>どっちもMicrosoft製なので。</li>
</ul></li>
<li>TypeScriptの方がドキュメントが充実してる</li>
<li>TypeScriptの方が、いざというときにソースが読みやすい

<ul>
<li>TypeScriptはTypeScriptで実装されてて、Flowは<a href="https://ocaml.org/">OCaml</a>で実装されてる。</li>
</ul></li>
</ul>

<p>参考:</p>

<ul>
<li><a href="https://github.com/niieani/typescript-vs-flowtype">https://github.com/niieani/typescript-vs-flowtype</a></li>
<li><a href="https://texta.pixta.jp/entry/2018/06/07/120000">https://texta.pixta.jp/entry/2018/06/07/120000</a></li>
<li><a href="https://narinymous.hatenablog.com/entry/2018/03/02/032130">https://narinymous.hatenablog.com/entry/2018/03/02/032130</a></li>
<li><a href="https://base.terrasky.co.jp/articles/zuUtT">https://base.terrasky.co.jp/articles/zuUtT</a></li>
</ul>

<p><br></p>

<p>前回の記事ではFlowを導入したんだけどTypeScriptに移行する羽目に。
FlowとTypeScriptとで型の表現方式や表現力にあまり差はなかったのでそこはまあ手間ではなかったんだけど、以下のような問題に対応する必要があった。</p>

<ul>
<li>ビルド時にTypeScriptの方が時間がかかる。</li>
<li>TypeScriptのリンタである<a href="https://palantir.github.io/tslint/">TSLint</a>が、FlowのESLintよりルールが貧弱

<ul>
<li>TypeScriptのコンパイラがチェックしてくれるからいいのかもしれないけど。</li>
</ul></li>
<li>TypeScriptはAltJSなので、何かと連携するときに何かと面倒

<ul>
<li>Jestでユニットテストするときはどうするんだっけとか</li>
<li>プレーンJavaScriptと混在した環境ではTSLintとESLint併用しなければいけないんだっけとか</li>
</ul></li>
</ul>

<h1 id="flowからtypescriptへの移行">FlowからTypeScriptへの移行</h1>

<h2 id="脱flow">脱Flow</h2>

<p>とりあえずFlowを取り除く。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn remove flow-bin flow-typed @babel/preset-flow eslint-plugin-flowtype babel-eslint
$ rm -f .flowconfig</code></pre></div>
<p><code>.babelrc</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> {
   &#34;presets&#34;: [
     [
       &#34;@babel/preset-env&#34;,
       {
         &#34;useBuiltIns&#34;: &#34;usage&#34;
       }
     ],
<span style="color:#d22323">-    &#34;@babel/preset-flow&#34;,
</span><span style="color:#d22323"></span>     &#34;@babel/preset-react&#34;
   ],
   &#34;plugins&#34;: [&#34;styled-components&#34;, &#34;@babel/plugin-syntax-dynamic-import&#34;]
 }
</code></pre></div>
<p><code>.eslintrc.js</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> module.exports = {
   env: {
     browser: true,
     &#39;jest/globals&#39;: true,
   },
<span style="color:#d22323">-  parser: &#39;babel-eslint&#39;,
</span><span style="color:#d22323">-  extends: [&#39;airbnb&#39;, &#39;plugin:flowtype/recommended&#39;, &#39;prettier&#39;],
</span><span style="color:#d22323">-  plugins: [&#39;flowtype&#39;, &#39;jest&#39;],
</span><span style="color:#d22323"></span><span style="color:#589819">+  extends: [&#39;airbnb&#39;, &#39;prettier&#39;],
</span><span style="color:#589819">+  plugins: [&#39;jest&#39;],
</span><span style="color:#589819"></span> };
</code></pre></div>
<p><br></p>

<p>環境はこれでよくて、あとは各<code>.js</code>ファイルと<code>.jsx</code>ファイルから<code>// @flow</code>を消して、型情報も消す。
(型情報はTypeScriptでも同じようなのを書くので残しておいてもいい。)</p>

<h2 id="typescript導入">TypeScript導入</h2>

<h3 id="パッケージインストール">パッケージインストール</h3>

<p>以下のパッケージを入れる。</p>

<ul>
<li><a href="https://www.npmjs.com/package/typescript">typescript</a>: TypeScript本体。コンパイラ(tsc)等を含む。</li>
<li><code>@types/*</code>: 各3rdパーティライブラリの<a href="https://github.com/DefinitelyTyped/DefinitelyTyped">型定義ファイル(DefinitelyTyped)</a>。(型定義はライブラリ本体のパッケージに含まれている場合もある。)</li>
<li><a href="https://github.com/s-panferov/awesome-typescript-loader">awesome-typescript-loader</a>: TypeScriptを処理するためのwebpackのローダ。他の選択肢として<a href="https://github.com/TypeStrong/ts-loader">ts-loader</a>があるが、<a href="https://www.typescriptlang.org/docs/handbook/react-&amp;-webpack.html">公式のチュートリアル</a>がawesome-typescript-loaderをメインで紹介してるのでこっちにする。</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn add -D typescript @types/react @types/react-dom @types/react-redux @types/redux-logger @types/history @types/react-router-dom @types/uuid @types/styled-components awesome-typescript-loader</code></pre></div>
<p>TypeScriptはv3.1.6、awesome-typescript-loaderはv5.2.1が入った。</p>

<h3 id="typescriptの設定">TypeScriptの設定</h3>

<p><a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html">TypeScriptの設定ファイル</a>であるtsconfig.jsonはtscコマンドでテンプレートを生成できる。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn tsc --init</code></pre></div>
<p>生成されたファイルをプロジェクトルートに置いて、ちょっといじって以下の感じに。
(jsonなのにコメント書ける…)</p>

<p><code>tsconfig.json</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
  <span style="color:#ed9d13">&#34;compilerOptions&#34;</span>: {
    <span style="color:#999;font-style:italic">/* Basic Options */</span>
    <span style="color:#ed9d13">&#34;target&#34;</span>: <span style="color:#ed9d13">&#34;es5&#34;</span> <span style="color:#999;font-style:italic">/* Specify ECMAScript target version: &#39;ES3&#39; (default), &#39;ES5&#39;, &#39;ES2015&#39;, &#39;ES2016&#39;, &#39;ES2017&#39;,&#39;ES2018&#39; or &#39;ESNEXT&#39;. */</span>,
    <span style="color:#ed9d13">&#34;module&#34;</span>: <span style="color:#ed9d13">&#34;esnext&#34;</span> <span style="color:#999;font-style:italic">/* Specify module code generation: &#39;none&#39;, &#39;commonjs&#39;, &#39;amd&#39;, &#39;system&#39;, &#39;umd&#39;, &#39;es2015&#39;, or &#39;ESNext&#39;. */</span>,
    <span style="color:#ed9d13">&#34;lib&#34;</span>: [<span style="color:#ed9d13">&#34;es2015&#34;</span>, <span style="color:#ed9d13">&#34;dom&#34;</span>] <span style="color:#999;font-style:italic">/* Specify library files to be included in the compilation. */</span>,
    <span style="color:#999;font-style:italic">// &#34;allowJs&#34;: true,                       /* Allow javascript files to be compiled. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;checkJs&#34;: true,                       /* Report errors in .js files. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#ed9d13">&#34;jsx&#34;</span>: <span style="color:#ed9d13">&#34;react&#34;</span> <span style="color:#999;font-style:italic">/* Specify JSX code generation: &#39;preserve&#39;, &#39;react-native&#39;, or &#39;react&#39;. */</span>,
    <span style="color:#999;font-style:italic">// &#34;declaration&#34;: true,                   /* Generates corresponding &#39;.d.ts&#39; file. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;declarationMap&#34;: true,                /* Generates a sourcemap for each corresponding &#39;.d.ts&#39; file. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#ed9d13">&#34;sourceMap&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Generates corresponding &#39;.map&#39; file. */</span>,
    <span style="color:#999;font-style:italic">// &#34;outFile&#34;: &#34;./&#34;,                       /* Concatenate and emit output to single file. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;outDir&#34;: &#34;./&#34;,                        /* Redirect output structure to the directory. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;rootDir&#34;: &#34;./&#34;,                       /* Specify the root directory of input files. Use to control the output directory structure with --outDir. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;composite&#34;: true,                     /* Enable project compilation */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#ed9d13">&#34;removeComments&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Do not emit comments to output. */</span>,
    <span style="color:#999;font-style:italic">// &#34;noEmit&#34;: true,                        /* Do not emit outputs. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;importHelpers&#34;: true,                 /* Import emit helpers from &#39;tslib&#39;. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;downlevelIteration&#34;: true,            /* Provide full support for iterables in &#39;for-of&#39;, spread, and destructuring when targeting &#39;ES5&#39; or &#39;ES3&#39;. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;isolatedModules&#34;: true,               /* Transpile each file as a separate module (similar to &#39;ts.transpileModule&#39;). */
</span><span style="color:#999;font-style:italic"></span>
    <span style="color:#999;font-style:italic">/* Strict Type-Checking Options */</span>
    <span style="color:#ed9d13">&#34;strict&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Enable all strict type-checking options. */</span>,
    <span style="color:#ed9d13">&#34;noImplicitAny&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Raise error on expressions and declarations with an implied &#39;any&#39; type. */</span>,
    <span style="color:#ed9d13">&#34;strictNullChecks&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Enable strict null checks. */</span>,
    <span style="color:#ed9d13">&#34;strictFunctionTypes&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Enable strict checking of function types. */</span>,
    <span style="color:#ed9d13">&#34;strictPropertyInitialization&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Enable strict checking of property initialization in classes. */</span>,
    <span style="color:#ed9d13">&#34;noImplicitThis&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Raise error on &#39;this&#39; expressions with an implied &#39;any&#39; type. */</span>,
    <span style="color:#ed9d13">&#34;alwaysStrict&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Parse in strict mode and emit &#34;use strict&#34; for each source file. */</span>,

    <span style="color:#999;font-style:italic">/* Additional Checks */</span>
    <span style="color:#ed9d13">&#34;noUnusedLocals&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Report errors on unused locals. */</span>,
    <span style="color:#ed9d13">&#34;noUnusedParameters&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Report errors on unused parameters. */</span>,
    <span style="color:#ed9d13">&#34;noImplicitReturns&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Report error when not all code paths in function return a value. */</span>,
    <span style="color:#ed9d13">&#34;noFallthroughCasesInSwitch&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Report errors for fallthrough cases in switch statement. */</span>,

    <span style="color:#999;font-style:italic">/* Module Resolution Options */</span>
    <span style="color:#ed9d13">&#34;moduleResolution&#34;</span>: <span style="color:#ed9d13">&#34;node&#34;</span> <span style="color:#999;font-style:italic">/* Specify module resolution strategy: &#39;node&#39; (Node.js) or &#39;classic&#39; (TypeScript pre-1.6). */</span>,
    <span style="color:#999;font-style:italic">// &#34;baseUrl&#34;: &#34;./&#34;,                       /* Base directory to resolve non-absolute module names. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;paths&#34;: {},                           /* A series of entries which re-map imports to lookup locations relative to the &#39;baseUrl&#39;. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;rootDirs&#34;: [],                        /* List of root folders whose combined content represents the structure of the project at runtime. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;typeRoots&#34;: [],                       /* List of folders to include type definitions from. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#ed9d13">&#34;types&#34;</span>: [] <span style="color:#999;font-style:italic">/* Type declaration files to be included in compilation. */</span>,
    <span style="color:#999;font-style:italic">// &#34;allowSyntheticDefaultImports&#34;: true,  /* Allow default imports from modules with no default export. This does not affect code emit, just typechecking. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#ed9d13">&#34;esModuleInterop&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span> <span style="color:#999;font-style:italic">/* Enables emit interoperability between CommonJS and ES Modules via creation of namespace objects for all imports. Implies &#39;allowSyntheticDefaultImports&#39;. */</span>
    <span style="color:#999;font-style:italic">// &#34;preserveSymlinks&#34;: true,              /* Do not resolve the real path of symlinks. */
</span><span style="color:#999;font-style:italic"></span>
    <span style="color:#999;font-style:italic">/* Source Map Options */</span>
    <span style="color:#999;font-style:italic">// &#34;sourceRoot&#34;: &#34;&#34;,                      /* Specify the location where debugger should locate TypeScript files instead of source locations. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;mapRoot&#34;: &#34;&#34;,                         /* Specify the location where debugger should locate map files instead of generated locations. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;inlineSourceMap&#34;: true,               /* Emit a single file with source maps instead of having a separate file. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;inlineSources&#34;: true,                 /* Emit the source alongside the sourcemaps within a single file; requires &#39;--inlineSourceMap&#39; or &#39;--sourceMap&#39; to be set. */
</span><span style="color:#999;font-style:italic"></span>
    <span style="color:#999;font-style:italic">/* Experimental Options */</span>
    <span style="color:#999;font-style:italic">// &#34;experimentalDecorators&#34;: true,        /* Enables experimental support for ES7 decorators. */
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// &#34;emitDecoratorMetadata&#34;: true,         /* Enables experimental support for emitting type metadata for decorators. */
</span><span style="color:#999;font-style:italic"></span>  },
  <span style="color:#ed9d13">&#34;files&#34;</span>: [<span style="color:#ed9d13">&#34;src/index.tsx&#34;</span>],
  <span style="color:#ed9d13">&#34;awesomeTypescriptLoaderOptions&#34;</span>: {
    <span style="color:#ed9d13">&#34;useCache&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span>,
    <span style="color:#ed9d13">&#34;reportFiles&#34;</span>: [<span style="color:#ed9d13">&#34;src/**/*.{ts,tsx}&#34;</span>],
    <span style="color:#ed9d13">&#34;forceIsolatedModules&#34;</span>: <span style="color:#6ab825;font-weight:bold">true</span>
  }
}
</code></pre></div>
<p>この設定ファイルのポイントは以下。</p>

<ul>
<li><code>compilerOptions</code>: tscのオプション。

<ul>
<li><code>target</code>: コード生成方法をアプリを動作させる環境に合わせて設定するオプション。IE11を含むブラウザを想定して<code>es5</code>を設定。</li>
<li><code>module</code>: モジュールコード(importとかexportとか?)の生成方法をアプリを動作させる環境に合わせて設定するオプション。大抵は<code>commonjs</code>でいいけど、<a href="https://github.com/tc39/proposal-dynamic-import">ダイナミックインポート</a>を使うために<code>esnext</code>を設定。(参考: <a href="https://stackoverflow.com/questions/45149091/typescript-use-dynamic-import-in-es5-with-bluebird">https://stackoverflow.com/questions/45149091/typescript-use-dynamic-import-in-es5-with-bluebird</a>)</li>
<li><code>lib</code>: コンパイル時に取り込むライブラリを設定するオプション。ターゲットが<code>es5</code>の場合はデフォルトで<code>[dom,es5,ScriptHost]</code>が設定されるけど、それだとジェネレータとかダイナミックインポートを使う場合に「<code>ERROR in [at-loader] TS2468: Cannot find global value 'Promise'.</code>」というエラーがでる。ので<code>es2015</code>を追加する必要がある。<code>document.getElementById()</code>をするのに<code>dom</code>も必要だけど、<code>ScriptHost</code>は無くてもなんだかビルドできるので、<code>[&quot;es2015&quot;, &quot;dom&quot;]</code>を設定。</li>
<li><code>allowJs</code>: デフォルトではTypeScript(i.e. <code>.ts</code>ファイルと<code>.tsx</code>ファイル)以外があるとエラーになるけど、このオプションを<code>true</code>にするとJavaScript(i.e. <code>.js</code>ファイルと<code>.jsx</code>ファイル)も混在させられる。とりあえずデフォルトの<code>false</code>のままにしておく。</li>
<li><code>checkJs</code>: allowJsを<code>true</code>にしていた場合、JavaScriptファイルのエラーチェックをするかを設定するオプション。エラーチェックをするかは、Flowみたいに<a href="https://www.typescriptlang.org/docs/handbook/type-checking-javascript-files.html">ソースごとにコメントで制御することもできる</a>。<code>allowJs</code>は<code>false</code>にするので関係なし。</li>
<li><code>jsx</code>: <a href="https://www.typescriptlang.org/docs/handbook/jsx.html">JSXのコードをどう処理するかを設定するオプション</a>。プレーンなJavaScriptに変換してほしいので、<code>react</code>を設定。</li>
<li><code>moduleResolution</code>: <a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html">モジュールの検索方法を設定するオプション</a>。npmのパッケージ(i.e. <code>node_modules</code>ディレクトリ内のモジュール)を使うので<code>node</code>を設定。(<code>node</code>以外にするケースはほとんどなさそう。)</li>
<li><code>types</code>: <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html#types-typeroots-and-types">コンパイル時に自動で取り込む型定義ファイルを設定するオプション</a>。明示的にimportするものはここに書かなくてもいい。(ソースに<code>import 'hoge'</code>と書けば<code>node_modules/</code>と<code>node_modules/@types/</code>内からhogeパッケージが検索される。)とりあえず自動で取り込むようなものはないので<code>[]</code>を設定。</li>
<li><code>esModuleInterop</code>: Babel界との調停のための<code>true</code>にしておくべきオプション。正直よくわからないが、Babelも併用するし、<a href="https://qiita.com/karak/items/29ff148788f5abb15331">積極的に有効にすべき</a>らしいので<code>true</code>に設定。</li>
</ul></li>
<li>files: <code>include</code>と<code>exclude</code>と合わせて、コンパイル対象ファイルを指定するオプション。指定したファイルがimportするファイルは自動でコンパイル対象になる。ので、webpack設定の<code>entry</code>に設定しているもの(i.e. <code>[&quot;src/index.tsx&quot;]</code>)を<code>files</code>に設定。(大抵のケースはこれでいいはず。)</li>
<li><code>awesomeTypescriptLoaderOptions</code>: awesome-typescript-loaderのオプション。

<ul>
<li><code>useCache</code>: <a href="https://github.com/s-panferov/awesome-typescript-loader#performance-issues">ビルド速度向上のために</a><code>true</code>を設定してファイルキャッシュを有効にする。キャッシュはプロジェクトルートの<code>.awcache</code>ディレクトリに保存されるので、これを.gitignoreに追加。</li>
<li><code>reportFiles</code>: エラーチェックするファイルを設定するオプション。自分が書いたソースだけ見てくれればいいので、<code>src/</code>以下を設定。ちゃんと設定しておかないと<code>node_modules/</code>以下のファイルのエラーチェックもしちゃう。</li>
<li><code>forceIsolatedModules</code>: <a href="https://github.com/s-panferov/awesome-typescript-loader#performance-issues">ビルド速度向上のために</a><code>true</code>を設定してモジュールのリコンパイルを抑制する。モジュールがプレーンJavaScriptに変換済みのものだけならこれで問題ないはず。(つまり大抵はこれでいいはず。)</li>
</ul></li>
</ul>

<h3 id="webpackの設定">webpackの設定</h3>

<p><a href="https://github.com/s-panferov/awesome-typescript-loader#configuration">awesome-typescript-loaderのドキュメント</a>の通りにwebpackを設定する。</p>

<p><code>webpack.common.js</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> const path = require(&#39;path&#39;);
<span style="color:#589819">+const { CheckerPlugin } = require(&#39;awesome-typescript-loader&#39;);
</span><span style="color:#589819"></span> const packageJson = require(&#39;./package.json&#39;);

 module.exports = {
   entry: [`./${packageJson.main}`],
   output: {
     path: path.resolve(__dirname, &#39;dist&#39;),
     filename: &#39;bundle.js&#39;,
   },
   module: {
     rules: [
       {
         test: /\.(js|jsx)$/,
         include: [path.resolve(__dirname, &#39;src&#39;)],
         enforce: &#39;pre&#39;,
         loader: &#39;eslint-loader&#39;,
         options: {
           configFile: &#39;./.eslintrc.js&#39;,
           failOnError: true,
         },
       },
       {
         test: /\.(js|jsx)$/,
         include: [path.resolve(__dirname, &#39;src&#39;)],
         enforce: &#39;pre&#39;,
         loader: &#39;stylelint-custom-processor-loader&#39;,
       },
       {
         test: /\.(js|jsx)$/,
         include: [path.resolve(__dirname, &#39;src&#39;)],
         loader: &#39;babel-loader&#39;,
       },
<span style="color:#589819">+      {
</span><span style="color:#589819">+        test: /\.(ts|tsx)$/,
</span><span style="color:#589819">+        include: [path.resolve(__dirname, &#39;src&#39;)],
</span><span style="color:#589819">+        loader: &#39;awesome-typescript-loader&#39;,
</span><span style="color:#589819">+      },
</span><span style="color:#589819"></span>       {
         test: /\.(png|woff|woff2|eot|ttf|svg)$/,
         include: [path.resolve(__dirname, &#39;node_modules&#39;)],
         loader: &#39;file-loader&#39;,
       },
     ],
   },
   resolve: {
<span style="color:#d22323">-    extensions: [&#39;*&#39;, &#39;.js&#39;, &#39;.jsx&#39;],
</span><span style="color:#d22323"></span><span style="color:#589819">+    extensions: [&#39;*&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.js&#39;, &#39;.jsx&#39;],
</span><span style="color:#589819"></span>     modules: [&#39;node_modules&#39;],
   },
<span style="color:#589819">+  plugins: [
</span><span style="color:#589819">+    new CheckerPlugin(),
</span><span style="color:#589819">+  ],
</span><span style="color:#589819"></span> };
</code></pre></div>
<p>とくにコメントなし。</p>

<p><br></p>

<p>awesome-typescript-loaderのドキュメントで推奨されている<a href="https://github.com/mzgoddard/hard-source-webpack-plugin">HardSourceWebpackPlugin</a>も導入しておく。
これを使うと、モジュールの中間キャッシュを生成して、二回目以降のビルドを高速化してくれる。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn add -D hard-source-webpack-plugin</code></pre></div>
<p><code>webpack.dev.js</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> const path = require(&#39;path&#39;);
 const webpackMerge = require(&#39;webpack-merge&#39;);
<span style="color:#589819">+const HardSourceWebpackPlugin = require(&#39;hard-source-webpack-plugin&#39;);
</span><span style="color:#589819"></span> const webpackCommon = require(&#39;./webpack.common.js&#39;);

 module.exports = webpackMerge(webpackCommon, {
   mode: &#39;development&#39;,
   devServer: {
     contentBase: path.join(__dirname, &#39;public&#39;),
     compress: true,
     hot: true,
     port: 3000,
     publicPath: &#39;http://localhost:3000/&#39;,
     historyApiFallback: true,
   },
<span style="color:#589819">+  plugins: [ new HardSourceWebpackPlugin() ],
</span><span style="color:#589819"></span> });
</code></pre></div>
<p>キャッシュは<code>node_modules/.cache/hard-source/</code>に保存される。
たまにキャッシュのせいでビルド時とか動作時に問題が起こるので、そんなときはこれを消す。</p>

<h3 id="フォーマッタの設定">フォーマッタの設定</h3>

<p><a href="https://prettier.io/docs/en/index.html">Prettier</a>は普通にTypeScriptをサポートしてるので、TypeScriptのファイルをフォーマット対象に加えるだけでいい。</p>

<p><code>package.json</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> (前略)
   &#34;scripts&#34;: {
<span style="color:#d22323">-    &#34;format&#34;: &#34;prettier --write **/*.jsx **/*.js **/*.css&#34;,
</span><span style="color:#d22323"></span><span style="color:#589819">+    &#34;format&#34;: &#34;prettier --write **/*.jsx **/*.js **/*.tsx **/*.ts **/*.css&#34;,
</span><span style="color:#589819"></span>     &#34;build&#34;: &#34;webpack --config webpack.prod.js&#34;,
     &#34;test&#34;: &#34;jest&#34;,
     &#34;start&#34;: &#34;webpack-dev-server --hot --config webpack.dev.js&#34;
   },
 (後略)
</code></pre></div>
<h3 id="リンタの設定">リンタの設定</h3>

<p>TypeScriptのリンティングは普通はTSLintを使う。
けど、すでに<a href="https://eslint.org/">ESLint</a>を<a href="https://www.kaitoy.xyz/2018/08/23/creating-react-redux-app-from-scratch-03/#eslint">がっつりセットアップ</a>してしまったのでTSLintに移行するのが面倒。
また、将来的にJavaScriptのコードも混在させるかもしれないので、そのときESLintとTSLintの設定(ルール)を同時にメンテするのは面倒。</p>

<p><a href="https://hokaccha.hatenablog.com/entry/2018/01/23/232625">この記事</a>によれば、<a href="https://github.com/eslint/typescript-eslint-parser">typescript-eslint-parser</a>を使えばそれらの面倒を回避できる。
typescript-eslint-parserはESLintのカスタムパーサで、TypeScriptのコードをESLintでリンティングすることを可能にする。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn add -D typescript-eslint-parser</code></pre></div>
<p>typescript-eslint-parserはv21.0.1が入った。
これを使うようにESLintを設定する。</p>

<p><code>.eslintrc.js</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> module.exports = {
   env: {
     browser: true,
     &#39;jest/globals&#39;: true,
   },
<span style="color:#589819">+  parser: &#39;typescript-eslint-parser&#39;,
</span><span style="color:#589819">+  parserOptions: {
</span><span style="color:#589819">+    jsx: true,
</span><span style="color:#589819">+    useJSXTextNode: false,
</span><span style="color:#589819">+  },
</span><span style="color:#589819"></span>   extends: [&#39;airbnb&#39;, &#39;prettier&#39;],
   plugins: [&#39;jest&#39;],
<span style="color:#589819">+  settings: {
</span><span style="color:#589819">+    &#39;import/resolver&#39;: {
</span><span style="color:#589819">+      node: {
</span><span style="color:#589819">+        extensions: [&#39;.js&#39;, &#39;.jsx&#39;, &#39;.ts&#39;, &#39;.tsx&#39;],
</span><span style="color:#589819">+      },
</span><span style="color:#589819">+    },
</span><span style="color:#589819">+  },
</span><span style="color:#589819">+  rules: {
</span><span style="color:#589819">+    &#39;react/jsx-filename-extension&#39;: [&#39;error&#39;, { extensions: [&#39;.tsx&#39;, &#39;.jsx&#39;] }],
</span><span style="color:#589819">+  },
</span><span style="color:#589819">+  overrides: [
</span><span style="color:#589819">+    {
</span><span style="color:#589819">+      files: [&#39;**/*.ts&#39;, &#39;**/*.tsx&#39;],
</span><span style="color:#589819">+      rules: {
</span><span style="color:#589819">+        // Set &#39;no-unused-vars&#39; to off to suppress errors on importing types.
</span><span style="color:#589819">+        // (e.g. error  &#39;FunctionComponent&#39; is defined but never used  no-unused-vars)
</span><span style="color:#589819">+        // Unused vars are checked by TypeScript compiler (at-loader) instead.
</span><span style="color:#589819">+        &#39;no-unused-vars&#39;: &#39;off&#39;,
</span><span style="color:#589819">+      },
</span><span style="color:#589819">+    },
</span><span style="color:#589819">+  ],
</span><span style="color:#589819"></span> };
</code></pre></div>
<p>設定のポイントは以下。</p>

<ul>
<li><code>parser</code>にtypescript-eslint-parserを指定。</li>
<li><code>parserOptions.jsx</code>を<code>true</code>にするのはtypescript-eslint-parserの<a href="https://github.com/eslint/typescript-eslint-parser#configuration">要件</a>。</li>
<li><code>parserOptions.useJSXTextNode</code>を<code>false</code>にするのはESLintのv4を使う場合のtypescript-eslint-parserの<a href="https://github.com/eslint/typescript-eslint-parser#configuration">要件</a>。</li>
<li><code>settings[import/resolver].node.extensions</code>は、importするモジュールのパス解決の設定。デフォルトではJavaScriptの拡張子しか検索しないので、TypeScriptのモジュールが見つからなくてESLintが「<code>Unable to resolve path to module './components/App'  import/no-unresolved</code>」みたいなエラーを吐く。これを防ぐためにTypeScriptの拡張子を追加する。(webpack.common.jsの<code>resolve.extensions</code>と同じ拡張子を設定しておく。)</li>
<li><code>rules</code>では、JSXファイルの拡張子名を制限するルール<code>react/jsx-filename-extension</code>を定義している。<code>extends</code>している<code>airbnb</code>の設定では<code>.jsx</code>だけになっているので<code>.tsx</code>を追加する意図。</li>
<li><code>overrides</code>では、宣言だけして使っていない変数をエラーにするルール<code>no-unused-vars</code>をTypeScriptに対して無効にしている。型をimportして使うコードを書くとエラーになっちゃうことがあるので。同様のチェックはTypeScriptのコンパイラがしてくれるので問題なし。</li>
</ul>

<p>(2019/1/25追記: TypeScriptチームがTSLintからESLintに移行することが<a href="https://qiita.com/mysticatea/items/aaf677928e965abe093d">発表された</a>。今後はTypeScriptはESLintでチェックするのがスタンダードになる。それに伴ってtypescript-eslint-parserは<a href="https://www.npmjs.com/package/@typescript-eslint/parser"> @typescript-eslint/parser</a>に置き換えられる。)</p>

<p><br></p>

<p>CSS(というか<a href="https://github.com/styled-components/styled-components">styled-components</a>)のリンタの<a href="https://github.com/stylelint/stylelint">stylelint</a>は<a href="https://github.com/styled-components/stylelint-processor-styled-components#setup">TypeScriptに対応している</a>のでケアする必要なし。</p>

<h3 id="javascriptをtypescriptへ書き換える">JavaScriptをTypeScriptへ書き換える</h3>

<p>とりあえず、<code>src/</code>以下の全ファイル(<code>src/__tests__/</code>以下は除く)について、拡張子を<code>.js</code>と<code>.jsx</code>から<code>.ts</code>と<code>.tsx</code>に変える。</p>

<p>型付けについては、<a href="https://www.typescriptlang.org/docs/handbook/basic-types.html">TypeScriptのドキュメント</a>の他、以下の記事を参考にした。</p>

<ul>
<li><a href="https://speakerdeck.com/lemon/typescript-fsanilai-ranaireact-x-redux">typescript-fsaに頼らないReact × Redux</a></li>
<li><a href="https://qiita.com/terrierscript/items/b3f9dd95a4c7afe0b102">TypeScript + Reduxはもうぼちぼちサードライブラリに頼らなくてもある程度はいい感じに補完してくれる</a></li>
<li><a href="https://piotrwitek.github.io/react-redux-typescript-guide/">react-redux-typescript-guide</a></li>
</ul>

<h4 id="reactコンポーネントの型">Reactコンポーネントの型</h4>

<p>Function Componentは、propsの型を<a href="https://www.typescriptlang.org/docs/handbook/interfaces.html">interface</a>で作って、<code>React.FunctionComponent</code>で型付ける。
<a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html#type-aliases">型エイリアス</a>の<code>type</code>じゃなくて<code>interface</code>を使うのは、<a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html#interfaces-vs-type-aliases">公式が基本はinterfaceを使え</a>と言ってるので。
因みに<code>React.FunctionComponent</code>の代わりに<code>React.SFC</code>を使ってるのをよく見るが、それは古い書き方。</p>

<p>例えば<a href="https://www.kaitoy.xyz/2018/11/07/creating-react-redux-app-from-scratch-10/">前回</a>書いた<code>MyDialog</code>は以下のように書ける。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#6ab825;font-weight:bold">import</span> React, { FunctionComponent } from <span style="color:#ed9d13">&#39;react&#39;</span>;
<span style="color:#6ab825;font-weight:bold">import</span> Dialog from <span style="color:#ed9d13">&#39;@material-ui/core/Dialog&#39;</span>;
<span style="color:#6ab825;font-weight:bold">import</span> DialogTitle from <span style="color:#ed9d13">&#39;@material-ui/core/DialogTitle&#39;</span>;
<span style="color:#6ab825;font-weight:bold">import</span> PropTypes from <span style="color:#ed9d13">&#39;prop-types&#39;</span>;

<span style="color:#999;font-style:italic">// Props型の定義
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">interface</span> Props {
  text: string;
  open: <span style="color:#6ab825;font-weight:bold">boolean</span>;
}

<span style="color:#999;font-style:italic">// Function Componentの定義
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">const</span> MyDialog: FunctionComponent&lt;<span style="color:#6ab825;font-weight:bold">Props</span>&gt; = ({ text, open }) =&gt; (
  &lt;<span style="color:#6ab825;font-weight:bold">Dialog</span> <span style="color:#bbb">open</span>=<span style="color:#ed9d13">{open}</span>&gt;
    &lt;<span style="color:#6ab825;font-weight:bold">DialogTitle</span>&gt;{text}&lt;/<span style="color:#6ab825;font-weight:bold">DialogTitle</span>&gt;
  &lt;/<span style="color:#6ab825;font-weight:bold">Dialog</span>&gt;
);

MyDialog.propTypes = {
  text: PropTypes.string.isRequired,
  open: PropTypes.bool.isRequired,
};

<span style="color:#6ab825;font-weight:bold">export</span> <span style="color:#6ab825;font-weight:bold">default</span> MyDialog;</code></pre></div>
<p><br></p>

<p>Container Componentは、Store型を<code>configureStore.ts</code>辺りで定義しておいて、それを<code>connect</code>するときの<code>mapStateToProps</code>で使う。
Storeのプロパティは、Reducerの型付け(後述)のためにそれぞれStateとして型付けしておく。</p>

<p><a href="https://www.kaitoy.xyz/2018/09/26/creating-react-redux-app-from-scratch-06/#reducer">以前</a>書いた<code>state</code>をStore型として定義すると以下のようになる。</p>

<p>Store型:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#6ab825;font-weight:bold">export</span> <span style="color:#6ab825;font-weight:bold">interface</span> HogeState {
  clicked: <span style="color:#6ab825;font-weight:bold">boolean</span>;
}

<span style="color:#6ab825;font-weight:bold">export</span> <span style="color:#6ab825;font-weight:bold">interface</span> Store {
  hoge: <span style="color:#6ab825;font-weight:bold">HogeState</span>;
}</code></pre></div>
<p>これを使うコードは以下。
(<a href="https://www.kaitoy.xyz/2018/10/01/creating-react-redux-app-from-scratch-07/#connect-%E3%81%AE%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AA%E6%9B%B8%E3%81%8D%E6%96%B9">以前の記事</a>で書いた<code>HogeButton</code>からの差分。)</p>

<p><code>src/containers/HogeButton.ts</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> import React from &#39;react&#39;;
 import Button from &#39;@material-ui/core/Button&#39;;
 import { connect } from &#39;react-redux&#39;;
 import { hogeButtonClicked } from &#39;../actions/actions&#39;;
<span style="color:#589819">+import { Store } from &#39;../configureStore&#39;;
</span><span style="color:#589819"></span>
 const HogeButton = connect(
<span style="color:#d22323">-  ({hoge}) =&gt; ({
</span><span style="color:#d22323"></span><span style="color:#589819">+  ({hoge}: Store) =&gt; ({
</span><span style="color:#589819"></span>     clicked: hoge.clicked
   }),
   {
     onClick: hogeButtonClicked,
   },
 )(Button);

 export default HogeButton;
</code></pre></div>
<p><br></p>

<p>Class Componentの型付け方法は<a href="https://speakerdeck.com/lemon/typescript-fsanilai-ranaireact-x-redux?slide=7">typescript-fsaに頼らないReact × Redux</a>の通りでよさそう。
正直あまり考えてない…。
Class Componentはまだ書いてないし、<a href="https://reactjs.org/docs/hooks-intro.html">React Hooks</a>が出てきて、Class Componentは非推奨になりそうでもあるし。</p>

<h4 id="reduxのactionの型">ReduxのActionの型</h4>

<p>Actionの型は、<code>redux</code>パッケージに基本的な型が定義されているのでそれを拡張して作る。
<code>redux</code>パッケージのは<code>string</code>の<code>type</code>プロパティだけがある型なので、<a href="https://github.com/redux-utilities/flux-standard-action">Flux Standard Action</a>(FSA)的な形にするために、<code>error</code>、<code>payload</code>、<code>meta</code>の3つのプロパティを<a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html#optional-parameters-and-properties">オプショナル</a>で追加する。
<code>error</code>は<code>boolean</code>で、<code>payload</code>と<code>meta</code>は<a href="https://www.typescriptlang.org/docs/handbook/generics.html">ジェネリクス</a>で型を指定する。</p>

<p>このAction型から、<code>type</code>、<code>payload</code>、<code>meta</code>の型を指定した型エイリアスを作ったり、<a href="https://www.typescriptlang.org/docs/handbook/interfaces.html#extending-interfaces">extends</a>したりして、個々のActionごとに具体的な型を作る。
<code>type</code>プロパティは、<a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html#string-literal-types">文字列リテラル型</a>としてAction Typeで型付ける。</p>

<p>例えば、<a href="https://www.kaitoy.xyz/2018/10/07/creating-react-redux-app-from-scratch-08/#rest-api%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%82%92%E8%A1%A8%E7%8F%BE%E3%81%99%E3%82%8Baction">以前</a>書いたAction Creatorは以下のように型付ける。</p>

<p><code>src/actions/actions.ts</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#589819">+import Redux from &#39;redux&#39;;
</span><span style="color:#589819"></span>
 import {
   HOGE_BUTTON_CLICKED,
   HOGE_FETCH_SUCCEEDED,
   HOGE_FETCH_FAILED,
 } from &#39;./actionTypes&#39;;

<span style="color:#589819">+// Action型の定義。
</span><span style="color:#589819">+export interface HogeAction&lt;Type, Payload = undefined, Meta = undefined&gt;
</span><span style="color:#589819">+  extends Redux.Action&lt;Type&gt; {
</span><span style="color:#589819">+  error?: boolean;
</span><span style="color:#589819">+  payload?: Payload;
</span><span style="color:#589819">+  meta?: Meta;
</span><span style="color:#589819">+}
</span><span style="color:#589819"></span>
<span style="color:#589819">+// 型エイリアスによるAction型の具体化。
</span><span style="color:#589819">+// 「typeof HOGE_BUTTON_CLICKED」で文字列リテラル型を指定している。
</span><span style="color:#589819">+export type HogeButtonClicked = HogeAction&lt;typeof HOGE_BUTTON_CLICKED&gt;;
</span><span style="color:#589819"></span><span style="color:#d22323">-export function hogeButtonClicked() {
</span><span style="color:#d22323"></span><span style="color:#589819">+export function hogeButtonClicked(): HogeButtonClicked {
</span><span style="color:#589819"></span>   return {
     type: HOGE_BUTTON_CLICKED,
   };
 }

<span style="color:#589819">+// payloadの型の定義。
</span><span style="color:#589819">+interface HogeFetchSucceededPayload {
</span><span style="color:#589819">+  hoge: string;
</span><span style="color:#589819">+}
</span><span style="color:#589819">+// インターフェースによるAction型の具体化。payloadプロパティを必須化している。
</span><span style="color:#589819">+export interface HogeFetchSucceeded
</span><span style="color:#589819">+  extends HogeAction&lt;typeof HOGE_FETCH_SUCCEEDED, HogeFetchSucceededPayload, Object&gt; {
</span><span style="color:#589819">+  payload: HogeFetchSucceededPayload;
</span><span style="color:#589819">+}
</span><span style="color:#589819"></span><span style="color:#d22323">-export function hogeFetchSucceeded(payload, meta) {
</span><span style="color:#d22323"></span><span style="color:#589819">+export function hogeFetchSucceeded(
</span><span style="color:#589819">+  payload: HogeFetchSucceededPayload,
</span><span style="color:#589819">+  meta: Object,
</span><span style="color:#589819">+): HogeFetchSucceeded {
</span><span style="color:#589819"></span>   return {
     type: HOGE_FETCH_SUCCEEDED,
     payload,
     meta,
   };
 }

<span style="color:#589819">+export type HogeFetchFailed = HogeAction&lt;typeof HOGE_FETCH_FAILED, Object&gt;;
</span><span style="color:#589819"></span><span style="color:#d22323">-export function hogeFetchFailed(payload) {
</span><span style="color:#d22323"></span><span style="color:#589819">+export function hogeFetchFailed(payload: Object): HogeFetchFailed {
</span><span style="color:#589819"></span>   return {
     type: HOGE_FETCH_FAILED,
     error: true,
     payload,
   };
 }
</code></pre></div>
<h4 id="reduxのreducerの型">ReduxのReducerの型</h4>

<p>Reducerの型は<code>redux</code>パッケージの<code>Reducer</code>型を使う。
この<code>Reducer</code>型がジェネリクスで、引数の<code>state</code>と<code>action</code>の型を受けるので、すでに定義したState型と具体Action型をimportして渡す。</p>

<p>例えば、<a href="https://www.kaitoy.xyz/2018/09/26/creating-react-redux-app-from-scratch-06/#reducer">以前</a>書いたReducerは以下のように型付ける。</p>

<p><code>src/reducers/reducers.ts</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#589819">+import { Reducer } from &#39;redux&#39;;
</span><span style="color:#589819">+import { HogeState } from &#39;../configureStore&#39;;
</span><span style="color:#589819"></span> import { HOGE_BUTTON_CLICKED } from &#39;../actions/actionTypes&#39;;
<span style="color:#589819">+import { HogeButtonClicked } from &#39;../actions/actions&#39;;
</span><span style="color:#589819"></span>
<span style="color:#d22323">-export const hoge = (state = { clicked: false }, action) =&gt; {
</span><span style="color:#d22323"></span><span style="color:#589819">+export const hoge: Reducer&lt;HogeState, HogeButtonClicked&gt; = (
</span><span style="color:#589819">+  state = { clicked: false },
</span><span style="color:#589819">+  action,
</span><span style="color:#589819">+) =&gt; {
</span><span style="color:#589819"></span>   switch (action.type) {
     case HOGE_BUTTON_CLICKED:
       const newHoge = {
         clicked: true,
       };
       return Object.assign({}, state, newHoge);
     default:
       return state;
   }
 }
</code></pre></div>
<h4 id="スクリプト以外をimportするコードを修正">スクリプト以外をimportするコードを修正</h4>

<p>JavaScriptやTypeScript以外のファイルをimportするコードを書くと、コンパイル時にエラーになる。</p>

<p>今まで書いた中で該当するのは<code>src/fonts.ts</code>でフォントファイルをimportしている箇所で、「<code>TS2307: Cannot find module '../node_modules/typeface-roboto/files/roboto-lat
in-300.woff'.</code>」といったエラーが出る。</p>

<p>原因は<a href="https://stackoverflow.com/questions/36148639/webpack-not-able-to-import-images-using-express-and-angular2-in-typescript">webpackでロードすべきものをtscでロードしちゃってる</a>から。
フォントファイルはwebpack(のfile-loader)でロードすべき。</p>

<p>解決策は、<code>import</code>文はtscが処理しちゃうので、代わりに<code>require</code>関数を使うこと。</p>

<p><code>src/fonts.ts</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> import { createGlobalStyle } from &#39;styled-components&#39;;
<span style="color:#d22323">-import roboto300 from &#39;../node_modules/typeface-roboto/files/roboto-latin-300.woff&#39;;
</span><span style="color:#d22323"></span><span style="color:#589819">+const roboto300 = require(&#39;../node_modules/typeface-roboto/files/roboto-latin-300.woff&#39;);
</span><span style="color:#589819"></span>
 const Fonts = createGlobalStyle`
   /* roboto-300normal - latin */
   @font-face {
     font-family: &#39;Roboto&#39;;
     font-style: normal;
     font-display: swap;
     font-weight: 300;
     src:
       local(&#39;Roboto Light&#39;),
       local(&#39;Roboto-Light&#39;),
       url(&#39;${roboto300}&#39;) format(&#39;woff&#39;);
   }
 `;

 export default Fonts;
</code></pre></div>
<p>これだけ。</p>

<h3 id="jestの設定">Jestの設定</h3>

<p>Jestを実行するときはwebpackを介さないので、別途TypeScript対応する必要がある。
純粋なTypeScriptプロジェクトでは普通<a href="https://kulshekhar.github.io/ts-jest/">ts-jest
</a>を使うみたいだけど、<a href="https://www.kaitoy.xyz/2018/11/07/creating-react-redux-app-from-scratch-10/">前回</a>入れた<a href="https://www.npmjs.com/package/babel-jest">babel-jest</a>で事足りるようなのでこっちを使う。</p>

<p>babel-jestは、Jest実行時にテストコードと関連モジュールをBabelで処理してピュアなJavaScriptにしてくれるやつ。
TypeScriptをBabelで処理できるようにするには、<a href="https://babeljs.io/docs/en/babel-preset-typescript">@babel/preset-typescript</a>を入れておく必要がある。</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ yarn add -D @babel/preset-typescript</code></pre></div>
<p><code>.babelrc</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> {
   &#34;presets&#34;: [
     [
       &#34;@babel/preset-env&#34;,
       {
         &#34;useBuiltIns&#34;: &#34;usage&#34;
       }
     ],
<span style="color:#589819">+    &#34;@babel/preset-typescript&#34;,
</span><span style="color:#589819"></span>     &#34;@babel/preset-react&#34;
   ],
   &#34;plugins&#34;: [&#34;styled-components&#34;, &#34;@babel/plugin-syntax-dynamic-import&#34;]
 }
</code></pre></div>
<p><br></p>

<p>で、jest.config.jsを二か所いじる。</p>

<p>一つは、JestがTypeScriptの拡張子を認識するように、<code>moduleFileExtensions</code>に<code>ts</code>と<code>tsx</code>を追加する。
もう一つは、Jestがbabel-jestを呼び出すように、<code>transform</code>にパターンを追加する。</p>

<p><code>jest.config.js</code>:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"> // For a detailed explanation regarding each configuration property, visit:
 // https://jestjs.io/docs/en/configuration.html

 module.exports = {
   // All imported modules in your tests should be mocked automatically
   // automock: false,

   // Stop running tests after the first failure
   // bail: false,

   // Respect &#34;browser&#34; field in package.json when resolving modules
   // browser: false,

   // The directory where Jest should store its cached dependency information
   // cacheDirectory: &#34;C:\\Users\\kaitoy\\AppData\\Local\\Temp\\jest&#34;,

   // Automatically clear mock calls and instances between every test
   // clearMocks: false,

   // Indicates whether the coverage information should be collected while executing the test
   // collectCoverage: false,

   // An array of glob patterns indicating a set of files for which coverage information should be collected
   // collectCoverageFrom: null,

   // The directory where Jest should output its coverage files
   coverageDirectory: &#39;coverage&#39;,

   // An array of regexp pattern strings used to skip coverage collection
   // coveragePathIgnorePatterns: [
   //   &#34;\\\\node_modules\\\\&#34;
   // ],

   // A list of reporter names that Jest uses when writing coverage reports
   // coverageReporters: [
   //   &#34;json&#34;,
   //   &#34;text&#34;,
   //   &#34;lcov&#34;,
   //   &#34;clover&#34;
   // ],

   // An object that configures minimum threshold enforcement for coverage results
   // coverageThreshold: null,

   // Make calling deprecated APIs throw helpful error messages
   // errorOnDeprecated: false,

   // Force coverage collection from ignored files usin a array of glob patterns
   // forceCoverageMatch: [],

   // A path to a module which exports an async function that is triggered once before all test suites
   // globalSetup: null,

   // A path to a module which exports an async function that is triggered once after all test suites
   // globalTeardown: null,

   // A set of global variables that need to be available in all test environments
   // globals: {},

   // An array of directory names to be searched recursively up from the requiring module&#39;s location
   // moduleDirectories: [
   //   &#34;node_modules&#34;
   // ],

   // An array of file extensions your modules use
<span style="color:#d22323">-  // moduleFileExtensions: [
</span><span style="color:#d22323">-  //   &#34;js&#34;,
</span><span style="color:#d22323">-  //   &#34;json&#34;,
</span><span style="color:#d22323">-  //   &#34;jsx&#34;,
</span><span style="color:#d22323">-  //   &#34;node&#34;
</span><span style="color:#d22323">-  // ],
</span><span style="color:#d22323"></span><span style="color:#589819">+  moduleFileExtensions: [
</span><span style="color:#589819">+    &#34;ts&#34;,
</span><span style="color:#589819">+    &#34;tsx&#34;,
</span><span style="color:#589819">+    &#34;js&#34;,
</span><span style="color:#589819">+    &#34;json&#34;,
</span><span style="color:#589819">+    &#34;jsx&#34;,
</span><span style="color:#589819">+    &#34;node&#34;
</span><span style="color:#589819">+  ],
</span><span style="color:#589819"></span>
   // A map from regular expressions to module names that allow to stub out resources with a single module
   // moduleNameMapper: {},

   // An array of regexp pattern strings, matched against all module paths before considered &#39;visible&#39; to the module loader
   // modulePathIgnorePatterns: [],

   // Activates notifications for test results
   // notify: false,

   // An enum that specifies notification mode. Requires { notify: true }
   // notifyMode: &#34;always&#34;,

   // A preset that is used as a base for Jest&#39;s configuration
   // preset: null,

   // Run tests from one or more projects
   // projects: null,

   // Use this configuration option to add custom reporters to Jest
   // reporters: undefined,

   // Automatically reset mock state between every test
   // resetMocks: false,

   // Reset the module registry before running each individual test
   // resetModules: false,

   // A path to a custom resolver
   // resolver: null,

   // Automatically restore mock state between every test
   // restoreMocks: false,

   // The root directory that Jest should scan for tests and modules within
   // rootDir: null,

   // A list of paths to directories that Jest should use to search for files in
   // roots: [
   //   &#34;&lt;rootDir&gt;&#34;
   // ],

   // Allows you to use a custom runner instead of Jest&#39;s default test runner
   // runner: &#34;jest-runner&#34;,

   // The paths to modules that run some code to configure or set up the testing environment before each test
   // setupFiles: [],

   // The path to a module that runs some code to configure or set up the testing framework before each test
   // setupTestFrameworkScriptFile: null,

   // A list of paths to snapshot serializer modules Jest should use for snapshot testing
   // snapshotSerializers: [],

   // The test environment that will be used for testing
   // testEnvironment: &#34;jest-environment-jsdom&#34;,

   // Options that will be passed to the testEnvironment
   // testEnvironmentOptions: {},

   // Adds a location field to test results
   // testLocationInResults: false,

   // The glob patterns Jest uses to detect test files
   // testMatch: [
   //   &#34;**/__tests__/**/*.js?(x)&#34;,
   //   &#34;**/?(*.)+(spec|test).js?(x)&#34;
   // ],

   // An array of regexp pattern strings that are matched against all test paths, matched tests are skipped
   // testPathIgnorePatterns: [
   //   &#34;\\\\node_modules\\\\&#34;
   // ],

   // The regexp pattern Jest uses to detect test files
   // testRegex: &#34;&#34;,

   // This option allows the use of a custom results processor
   // testResultsProcessor: null,

   // This option allows use of a custom test runner
   // testRunner: &#34;jasmine2&#34;,

   // This option sets the URL for the jsdom environment. It is reflected in properties such as location.href
   testURL: &#39;http://localhost/&#39;,

   // Setting this value to &#34;fake&#34; allows the use of fake timers for functions such as &#34;setTimeout&#34;
   // timers: &#34;real&#34;,

   // A map from regular expressions to paths to transformers
<span style="color:#d22323">-  // transform: null,
</span><span style="color:#d22323"></span><span style="color:#589819">+  transform: {
</span><span style="color:#589819">+    &#39;^.+\\.jsx?$&#39;: &#39;babel-jest&#39;,
</span><span style="color:#589819">+    &#39;^.+\\.tsx?$&#39;: &#39;babel-jest&#39;,
</span><span style="color:#589819">+  },
</span><span style="color:#589819"></span>
   // An array of regexp pattern strings that are matched against all source file paths, matched files will skip transformation
   // transformIgnorePatterns: [
   //   &#34;\\\\node_modules\\\\&#34;
   // ],

   // An array of regexp pattern strings that are matched against all modules before the module loader will automatically return a mock for them
   // unmockedModulePathPatterns: undefined,

   // Indicates whether each individual test should be reported during the run
   // verbose: null,

   // An array of regexp patterns that are matched against all source file paths before re-running tests in watch mode
   // watchPathIgnorePatterns: [],

   // Whether to use watchman for file crawling
   // watchman: true,
 };
</code></pre></div>
<p><br></p>

<p>以上でTypeScriptへの移行完了。</p></div>

        <section class="share-buttons">
          <div class="fb-share-button share-button" data-href="https://www.kaitoy.xyz/2018/11/26/creating-react-redux-app-from-scratch-11/" data-layout="button_count" data-size="small"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">シェア</a></div>
          <div class="share-button">
            <a class="twitter-share-button"
              href="https://twitter.com/intent/tweet?text=React%20%2b%20Redux%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%97%e3%83%ad%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e3%81%ae%e3%83%86%e3%83%b3%e3%83%97%e3%83%ac%e3%83%bc%e3%83%88%e3%82%92%e4%bd%9c%e3%82%8b%20%e2%80%95%20%e3%81%9d%e3%81%ae11%3a%20Flow%e3%81%8b%e3%82%89TypeScript%e3%81%b8%e7%a7%bb%e8%a1%8c&amp;url=https%3a%2f%2fwww.kaitoy.xyz%2f2018%2f11%2f26%2fcreating-react-redux-app-from-scratch-11%2f">
            Tweet</a>
          </div>
          <div class="share-button">
            <a href="https://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/v4/public/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
          </div>
          <div class="share-button">
            <a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-lang="en"></a>
            <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
          </div>
        </section>
    </div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6244473643910448"
         data-ad-slot="1845600530"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <section class="tbd-pagination">
      <div class="row">
        <div class="col-sm-6">
          <div class="prev">
            
            <a href="https://www.kaitoy.xyz/2018/11/07/creating-react-redux-app-from-scratch-10/">
              <i class="fa fa-angle-left"></i>
              React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その10: Code Splitting、Flow、Jest、Enzyme
            </a>
            
          </div>
        </div>
        <div class="col-sm-6">
          <div class="next text-right">
            
            <a href="https://www.kaitoy.xyz/2019/03/08/k8s-zundoko-operator/">
              ズンドコキヨシ with Kubernetes Operator - KubebuilderでKubernetes Operatorを作ってみた
              <i class="fa fa-angle-right"></i>
            </a>
            
          </div>
        </div>
      </div>
    </section>

    
    

    

        <h4 class="page-header">Related</h4>

        <div class="related-links">
           <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/07/25/re-ducks-react-redux-with-reselect/">Reduxのモジュールアーキテクチャパターンre-ducksの実践 ― React-Redux with reselect</a></h4>
    <h5>Sat, Jul 25, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/reselect"><kbd class="item-tag">reselect</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/07/24/re-ducks-normalizr/">Reduxのモジュールアーキテクチャパターンre-ducksの実践 ― normalizr</a></h4>
    <h5>Fri, Jul 24, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/normalizr"><kbd class="item-tag">normalizr</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/07/13/re-ducks-sagas/">Reduxのモジュールアーキテクチャパターンre-ducksの実践 ― Saga</a></h4>
    <h5>Mon, Jul 13, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux-saga"><kbd class="item-tag">redux-saga</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/07/11/re-ducks-reducers-with-immer/">Reduxのモジュールアーキテクチャパターンre-ducksの実践 ― Reducer with immer</a></h4>
    <h5>Sat, Jul 11, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/immer"><kbd class="item-tag">immer</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/07/05/re-ducks-actions/">Reduxのモジュールアーキテクチャパターンre-ducksの実践 ― Action Creator</a></h4>
    <h5>Sun, Jul 5, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/05/27/re-ducks/">Reduxのモジュールアーキテクチャパターン ― re-ducks</a></h4>
    <h5>Wed, May 27, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/re-ducks"><kbd class="item-tag">re-ducks</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/05/05/atomic-design/">コンポーネント設計におけるAtomicデザイン</a></h4>
    <h5>Tue, May 5, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/atomic-design"><kbd class="item-tag">atomic-design</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/04/27/update-react-redux-scaffold-2020-02/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを2020年版にアップデート ― その2: パスエイリアス設定</a></h4>
    <h5>Mon, Apr 27, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/webpack"><kbd class="item-tag">webpack</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/eslint"><kbd class="item-tag">eslint</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/babel"><kbd class="item-tag">babel</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2020/04/26/update-react-redux-scaffold-2020-01/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを2020年版にアップデート ― その1: ライブラリ等の更新</a></h4>
    <h5>Sun, Apr 26, 2020</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/webpack"><kbd class="item-tag">webpack</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/babel"><kbd class="item-tag">babel</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/eslint"><kbd class="item-tag">eslint</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/prettier"><kbd class="item-tag">prettier</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/styled-components"><kbd class="item-tag">styled-components</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/material-ui"><kbd class="item-tag">material-ui</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux-saga"><kbd class="item-tag">redux-saga</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/react-router"><kbd class="item-tag">react-router</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/jest"><kbd class="item-tag">jest</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/react-testing-library"><kbd class="item-tag">react-testing-library</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/typescript"><kbd class="item-tag">typescript</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/11/07/creating-react-redux-app-from-scratch-10/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その10: Code Splitting、Flow、Jest、Enzyme</a></h4>
    <h5>Wed, Nov 7, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/flow"><kbd class="item-tag">flow</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/jest"><kbd class="item-tag">jest</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/enzyme"><kbd class="item-tag">enzyme</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/11/02/creating-react-redux-app-from-scratch-09/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その9: React Router</a></h4>
    <h5>Fri, Nov 2, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/react-router"><kbd class="item-tag">react-router</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/10/07/creating-react-redux-app-from-scratch-08/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その8: Redux-Saga</a></h4>
    <h5>Sun, Oct 7, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux-saga"><kbd class="item-tag">redux-saga</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/10/01/creating-react-redux-app-from-scratch-07/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その7: React Redux</a></h4>
    <h5>Mon, Oct 1, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/09/26/creating-react-redux-app-from-scratch-06/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その6: Redux</a></h4>
    <h5>Wed, Sep 26, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/redux"><kbd class="item-tag">redux</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/09/06/creating-react-redux-app-from-scratch-05/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その5: Material-UIとWebフォント</a></h4>
    <h5>Thu, Sep 6, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/material-ui"><kbd class="item-tag">material-ui</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/08/29/creating-react-redux-app-from-scratch-04/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その4: CSS ModulesとPostCSSとstylelintとstyled-components</a></h4>
    <h5>Wed, Aug 29, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/postcss"><kbd class="item-tag">postcss</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/stylelint"><kbd class="item-tag">stylelint</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/css-modules"><kbd class="item-tag">css-modules</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/styled-components"><kbd class="item-tag">styled-components</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/08/23/creating-react-redux-app-from-scratch-03/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その3: PrettierとESLint</a></h4>
    <h5>Thu, Aug 23, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/eslint"><kbd class="item-tag">eslint</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/prettier"><kbd class="item-tag">prettier</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/08/22/creating-react-redux-app-from-scratch-02/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その2: React</a></h4>
    <h5>Wed, Aug 22, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/08/19/creating-react-redux-app-from-scratch-01/">React &#43; Reduxアプリケーションプロジェクトのテンプレートを作る ― その1: Node.jsとYarnとBabelとwebpack</a></h4>
    <h5>Sun, Aug 19, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/webpack"><kbd class="item-tag">webpack</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/babel"><kbd class="item-tag">babel</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2018/08/16/chronicle-of-frontend-2018/">Webアプリケーションフロントエンド年代記 - 2018年夏編</a></h4>
    <h5>Thu, Aug 16, 2018</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/frontend"><kbd class="item-tag">frontend</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2017/08/25/if-youre-a-startup-you-should-not-use-react-reflecting-on-the-bsd-patents-license/">スタートアップはReactを使うべきではない (BSD &#43; patentsライセンスを考慮して) — もし、いつか大企業に買収されたいと望むなら</a></h4>
    <h5>Fri, Aug 25, 2017</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/license"><kbd class="item-tag">license</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4 class="post-title"><a href="/2015/12/21/hello-react/">ReactをAtomパッケージ開発に使ってみた</a></h4>
    <h5>Mon, Dec 21, 2015</h5>
    
    <a href="https://www.kaitoy.xyz/tags/react"><kbd class="item-tag">react</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/atom"><kbd class="item-tag">atom</kbd></a>
    
    <a href="https://www.kaitoy.xyz/tags/javascript"><kbd class="item-tag">javascript</kbd></a>
    

</div>
 
        </div>
    

    

        <h4 class="page-header">Comments</h4>

        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kaitoy-tobedecided" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    

</main>

        <footer>

            <p class="copyright text-muted">&copy; 2015 Kaito Yamada. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a></p>

        </footer>

    </body>

</html>

